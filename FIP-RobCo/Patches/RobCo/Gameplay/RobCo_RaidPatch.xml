<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <!-- Remove self-destroy comps from the biotech bosscallers -->
  <Operation Class="PatchOperationRemove">
    <xpath>/Defs/ThingDef[defName="BurnoutMechlinkBooster"]/comps/li[@Class="CompProperties_UseEffectDestroySelf"]</xpath>
  </Operation>

  <Operation Class="PatchOperationRemove">
    <xpath>/Defs/ThingDef[defName="MechbandDish"]/comps/li[@Class="CompProperties_UseEffectDestroySelf"]</xpath>
  </Operation>

  <!-- Give the CommsConsole a bossgroup caller for Vertibot -->
  <Operation Class="PatchOperationAdd">
    <xpath>/Defs/ThingDef[defName="CommsConsole"]/comps</xpath>
    <value>
      <li Class="CompProperties_Usable">
        <useJob>TriggerObject</useJob>
        <useLabel>Call Vertibot threat</useLabel>
        <useDuration>900</useDuration>
        <floatMenuOptionPriority>SummonThreat</floatMenuOptionPriority>
        <floatMenuFactionIcon>Mechanoid</floatMenuFactionIcon>
        <ignoreOtherReservations>true</ignoreOtherReservations>
      </li>
      <li Class="CompProperties_Useable_CallBossgroup">
        <bossgroupDef>RobCo_EyebotCrashed</bossgroupDef>
        <spawnLetterLabelKey>LetterLabelCommsConsoleSpawned</spawnLetterLabelKey>
        <spawnLetterTextKey>LetterCommsConsoleSpawned</spawnLetterTextKey>
        <effecterDef>CommsConsoleBossgroupSummoned</effecterDef>
        <delayTicks>120</delayTicks>
      </li>
    </value>
  </Operation>

    <!-- Give the BurnoutMechlinkBooster a bossgroup caller for Sheepsquatch -->
  <Operation Class="PatchOperationAdd">
    <xpath>/Defs/ThingDef[defName="BurnoutMechlinkBooster"]/comps</xpath>
    <value>
      <li Class="CompProperties_Usable">
        <useJob>TriggerObject</useJob>
        <useLabel>Call Sheepsquatch threat</useLabel>
        <useDuration>900</useDuration>
        <floatMenuOptionPriority>SummonThreat</floatMenuOptionPriority>
        <floatMenuFactionIcon>Mechanoid</floatMenuFactionIcon>
        <ignoreOtherReservations>true</ignoreOtherReservations>
      </li>
      <li Class="CompProperties_Useable_CallBossgroup">
        <bossgroupDef>RobCo_AssaultronSheepsquatch</bossgroupDef>
        <spawnLetterLabelKey>LetterLabelCommsConsoleSpawned</spawnLetterLabelKey>
        <spawnLetterTextKey>LetterCommsConsoleSpawned</spawnLetterTextKey>
        <effecterDef>CommsConsoleBossgroupSummoned</effecterDef>
        <delayTicks>120</delayTicks>
      </li>
    </value>
  </Operation>

    <!-- Give the MechbandDish a bossgroup caller for Deathbot -->
  <Operation Class="PatchOperationAdd">
    <xpath>/Defs/ThingDef[defName="MechbandDish"]/comps</xpath>
    <value>
      <li Class="CompProperties_Usable">
        <useJob>TriggerObject</useJob>
        <useLabel>Call Deathbot threat</useLabel>
        <useDuration>900</useDuration>
        <floatMenuOptionPriority>SummonThreat</floatMenuOptionPriority>
        <floatMenuFactionIcon>Mechanoid</floatMenuFactionIcon>
        <ignoreOtherReservations>true</ignoreOtherReservations>
      </li>
      <li Class="CompProperties_Useable_CallBossgroup">
        <bossgroupDef>RobCo_SentrybotDeathbot</bossgroupDef>
        <spawnLetterLabelKey>LetterLabelCommsConsoleSpawned</spawnLetterLabelKey>
        <spawnLetterTextKey>LetterCommsConsoleSpawned</spawnLetterTextKey>
        <effecterDef>CommsConsoleBossgroupSummoned</effecterDef>
        <delayTicks>120</delayTicks>
      </li>
    </value>
  </Operation>

</Patch>
